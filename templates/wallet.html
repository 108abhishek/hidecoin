<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>HideCoin Wallet</title>
<link href="/assets/bootstrap.min.css" rel="stylesheet" />
<script type="text/javascript" src="/assets/jquery.min.js"></script>
<script type="text/javascript" src="/assets/bootstrap.min.js"></script>
<script type="text/javascript" src="/assets/jquery.noty.packaged.min.js"></script>
<script type="text/javascript">
function notify(type, message) {
  var n = noty({
    text        : message,
    type        : type,
    dismissQueue: true,
    timeout     : 5000,
    closeWith   : ['click'],
    layout      : 'topCenter',
    theme       : 'defaultTheme',
    maxVisible  : 5
  });
}
</script>
</head>
<body>
<div class="container" style="margin-top: 100px">
  <div class="row">
    <div class="col-xs-12 text-center">
      <div class="panel panel-info">
        <div class="panel-heading">Information</div>
        <div class="panel-body">
          <div class="text-info" id="loading">Connecting...</div>
          <div class="text-warning">1 XHD = 100 000 000 micoins</div>
          <div>Balance: <span id="allAmount"></span> XHD</div>
          <div class="text-warning"><30 confirm. balance: <span id="allAmountSoft"></span> XHD</div>
          <div class="text-danger">Unconfirmed balance: <span id="allAmountUnconfirmed"></span> XHD</div>
          <div id="balances"></div>
            <form class="form-inline" role="form" id="create">
              <button type="submit" class="btn btn-success">Create new address</button>
            </form>
          <b class="text-warning">Note that you can spend coins only from transactions which have at least 30 confirmations.</b>
          <div id="send-coins">
            <form class="form-horizontal" role="form" id="send">
              <div class="form-group">
                <label class="col-sm-2" for="address">Send coins to</label>
                <div class="col-sm-10">
                  <input type="text" class="form-control" id="address" name="address" placeholder="Address">
                </div>
              </div>
              <div class="form-group">
                <label class="col-sm-2" for="amount">Amount in XHD</label>
                <div class="col-sm-10">
                  <input type="text" class="form-control" id="amount" name="amount" placeholder="Amount in XHD">
                </div>
              </div>
              <div class="form-group">
                <label class="col-sm-2" for="amountm">+amount in micoins</label>
                <div class="col-sm-10">
                  <input type="text" class="form-control" id="amountm" name="amounmt" placeholder="+amount in micoins">
                </div>
              </div>
              <div class="form-group">
                <label class="col-sm-2" for="fee">Fee (min. 1 XHD)</label>
                <div class="col-sm-10">
                  <input type="text" class="form-control" id="fee" name="fee" placeholder="Fee (min. 1 XHD)" value="1">
                </div>
              </div>
              <button type="submit" class="btn btn-success" id="submit">Send</button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="/socket.io/socket.io.js"></script>
<script>
socket = io.connect();
socket.on('connect', function () {
  $('#loading').addClass('hidden');
  socket.json.send({get: 'balances'});
});
socket.on('message', function (data) {
  if (data.reload) {
    location.href = '/';
  }
  if (data.noty) {
    notify(data.noty.type, data.noty.message);
    $('#submit').show();
  }
  if (data.balances) {
    $('#balances').html('');
    for (var i in data.balances) {
      $('#balances').append(i + ' : ' + data.balances[i] / 100000000 + ' XHD<br>');
    }
    $('#balancesSoft').html('');
    for (var i in data.balancesUnconfirmed) {
      $('#balancesSoft').append(i + ' : ' + data.balancesUnconfirmed[i] / 100000000 + ' XHD<br>');
    }
    $('#balancesUnconfirmed').html('');
    for (var i in data.balancesUnconfirmed) {
      $('#balancesUnconfirmed').append(i + ' : ' + data.balancesUnconfirmed[i] / 100000000 + ' XHD<br>');
    }
  }
  if (data.allAmount) {
    $('#allAmount').html(data.allAmount);
  }
  if (data.allAmountSoft) {
    $('#allAmountSoft').html(data.allAmountSoft);
  }
  if (data.allAmountUnconfirmed) {
    $('#allAmountUnconfirmed').html(data.allAmountUnconfirmed);
  }
});
socket.on('disconnect', function() {
  if ($('#loading').hasClass('hidden')) {
    $('#loading').removeClass('hidden');
  }
});

$(document).on('submit', '#send', function() {
  $('#submit').hide();
  socket.json.send({post: 'coins', address: $('#address').val(), amount: $('#amount').val(), amountm: $('#amountm').val(), fee: $('#fee').val()});
  return false;
});

$(document).on('submit', '#create', function() {
  socket.json.send({post: 'address'});
  return false;
});
</script>

</body>
</html>